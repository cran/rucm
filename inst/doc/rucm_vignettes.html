<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Unobserved Component Models in R</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Unobserved Component Models in R}
%\SweaveUTF8
-->

<h1>Unobserved Component Models in R</h1>

<h2>Introduction</h2>

<p>Unobserved Components Model (UCM) (Harvey (1989)) performs a time series decomposition into components such as trend, seasonal, cycle, and the regression effects due to predictor series. It can be represented as follows:</p>

<p>\[ 
\begin{aligned}
y_{t} & = \mu_{t} + \gamma_{t} + \psi_{t} + \sum_{j=1}^{m} \beta_{j} x_{jt} + \epsilon_{t} 
\end{aligned}
\]</p>

<p>\[
\begin{aligned}
\epsilon_{t} & \sim i.i.d. N(0, \sigma^2_{\epsilon})
\end{aligned}
\]</p>

<p>The components \(\mu_{t}\), \(\gamma_{t}\), and \(\psi_{t}\) represent the trend, seasonal, and cyclical components, respectively; the term \(\sum_{j=1}^{m} \beta_{j} x_{jt}\) gives the contribution of regression variables with fixed or time varying regression coefficients. </p>

<h3>Trend</h3>

<p>Trends are loosely defined as the natural tendency of the series to increase or decrease or remain constant over a period of time in absense of any other influencing variable. </p>

<p>UCM can model trend in two ways; first being the random walk model implying that trend remains roughly constant over the time period of the series, and the second being locaaly linear trend having an upward or downward slope.</p>

<h3>Cycle</h3>

<p>Cycles in a time series data exists when the data exhibit rises and falls that are not of fixed period. The duration of these fluctuations is usually of at least 2 years. </p>

<h3>Seasonality</h3>

<p>A seasonal pattern exists when there exists a consistent pattern of variation influenced by seasonal factors (e.g., the quarter of the year, or day of the week, etc.).</p>

<p>For a detailed discussion of all the above three factors see references below.</p>

<h2>rucm-Package</h2>

<p>Package <strong>rucm</strong> has been authored keeping in mind the easier specification of UCM in SAS using <a href="http://support.sas.com/documentation/cdl/en/etsug/60372/HTML/default/viewer.htm#ucm_toc.htm">PROC UCM</a>. <strong>rucm</strong> provides a wrapper function called <code>ucm</code> containing arguments specifying the formula for predictor variables, and other decomposition components such as level, slope, season, cycle, etc. to run UCM. <code>ucm</code> can also handle cases where we want to fix the variance of any of the above decomposition components.</p>

<p>To install <code>rucm</code>:</p>

<pre><code class="r">#install.packages(&quot;rucm&quot;)
library(rucm)
</code></pre>

<p>For help and the list of values that are returned see the <code>help(package = rucm)</code> or <code>?ucm</code>.</p>

<p>Here we work with the Nile data which comes along with the <code>datasets</code> package, measures the annual flow of the river Nile at Ashwan, in south Egypt, between 1871 and <U+FFFD><U+FFFD>1970.</p>

<p>To model the level of Nile annual flow:</p>

<pre><code class="r">modelNile &lt;- ucm(formula = Nile~0, data = Nile, level = TRUE)
modelNile #Printing method for class ucm
</code></pre>

<pre><code>#&gt; Call:
#&gt; ucm(formula = Nile ~ 0, data = Nile, level = TRUE)
#&gt; 
#&gt; Parameter estimates:
#&gt; NULL
#&gt; 
#&gt; Estimated variance:
#&gt; Irregular_Variance     Level_Variance 
#&gt;          15098.517           1469.175
</code></pre>

<pre><code class="r">plot(Nile, ylab = &quot;Flow of Nile&quot;)
lines(modelNile$s.level, col = &quot;blue&quot;)
legend(&quot;topright&quot;, legend = c(&quot;Observed flow&quot;,&quot;S_level&quot;), col = c(&quot;black&quot;,&quot;blue&quot;), lty = 1)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk modelNile" alt="plot of chunk modelNile" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>

<p>The <code>formula</code> argument in the <code>ucm</code> function takes an argument of the form <code>as.formula</code> in R. For multivariate UC Models, the rhs of the <code>formula</code> should contain the indepedent variables. If the model is univariate, we write a 0 in the rhs of the formula specification. Slope, seasonality, and cyclicity can be included by using <code>slope = TRUE</code>, <code>season = TRUE</code>, <code>cycle = TRUE</code>, specifying the seasonal and cyclical lengths of the series in the arguments <code>season.length</code> and <code>cycle.period</code>, respectively. </p>

<p><code>ucm</code> returns an object of class <code>ucm</code> having the estimate of predictors, estimated variances,  time series of unobserved components (level, slope, whatever is included), and time series of the variances of these components.</p>

<p>To forecast the time series, we use the <code>predict</code> function supplying the model name and number of periods to forecast in <code>n.ahead</code>.</p>

<pre><code class="r">modelNile &lt;- ucm(formula = Nile~0, data = Nile, level = TRUE, slope = TRUE)
predict(modelNile$model, n.ahead = 12) # Forecasting
</code></pre>

<pre><code>#&gt; Time Series:
#&gt; Start = 1971 
#&gt; End = 1982 
#&gt; Frequency = 1 
#&gt;  [1] 779.5699 776.1597 772.7496 769.3395 765.9293 762.5192 759.1091
#&gt;  [8] 755.6989 752.2888 748.8786 745.4685 742.0584
</code></pre>

<h2>References</h2>

<ol>
<li><p>Harvey A. (1989). <em>Forecasting, structural time series models and the Kalman filter</em>. Cambridge New York: Cambridge University Press</p></li>
<li><p>Helske J (2014). <strong>KFAS</strong>: <em>Kalman filter and Smoothers for Exponential Family State Space Models</em>. R package version 1.0.4-1, URL <a href="http://CRAN.R-project.org/package=KFAS">http://CRAN.R-project.org/package=KFAS</a>.</p></li>
<li><p><em>Hyndsight</em>. URL <a href="http://robjhyndman.com/hyndsight/cyclicts/">http://robjhyndman.com/hyndsight/cyclicts/</a>.</p></li>
<li><p>SAS Institute Inc (2010). <em>SAS/ETS 9.22 User&#39;s Guide</em>. SAS Institute Inc., Cary, NC. URL <a href="http://support.sas.com/documentation/cdl/en/etsug/60372/PDF/default/etsug.pdf">http://support.sas.com/documentation/cdl/en/etsug/60372/PDF/default/etsug.pdf</a>.</p></li>
<li><p>Selukar R (2011). &ldquo;State Space Modeling Using SAS&rdquo;. <em>Journal of Statistical Software</em>, <strong>41</strong>(12), 1-13. URL <a href="http://www.jstatsoft.org/v41/i12/">http://www.jstatsoft.org/v41/i12/</a>.</p></li>
<li><p>Petris G, Petrone S (2011). &ldquo;State Space Models in R&rdquo;. <em>Journal of Statistical Software</em>, <strong>41</strong>(4), 1-25. URL <a href="http://www.jstatsoft.org/v41/i04/">http://www.jstatsoft.org/v41/i04/</a>.</p></li>
</ol>

</body>

</html>
